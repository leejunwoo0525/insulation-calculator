# ì „ì²´ HTML ê³„ì‚°ê¸° ìµœì¢…ë²„ì „ (DB + PDF + ë“±ê¸‰ + ì¶”ê°€ ì…ë ¥ + í…Œì´ë¸” ì¶œë ¥ í¬í•¨)
# íŒŒì¼ ê²½ë¡œ ì„¤ì •
final_path = Path("/mnt/data/index_final_full_program.html")

# HTML ì½”ë“œ ì‘ì„± (ìš”ì•½ ì—†ì´ ì „ì²´ ê¸°ëŠ¥ í¬í•¨ ì½”ë“œ)
full_html = """
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ë‹¨ì—´ì¬ ì¶”ì²œ ê³„ì‚°ê¸°</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    table { border-collapse: collapse; margin-top: 10px; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 6px 10px; text-align: center; }
    input, select { width: 140px; }
    button { margin: 10px 5px; padding: 6px 16px; }
    tr.selected { background-color: #e0f0ff; }
    .grade-A { background-color: #d4f8cc; }
    .grade-B { background-color: #fff8b2; }
    .grade-C { background-color: #ffe0b2; }
    .grade-D { background-color: #f8cccc; }
    #result, #insulationTable { margin-top: 30px; }
  </style>
</head>
<body>

<h2>ğŸ“¦ ë‹¨ì—´ì¬ ì¶”ì²œ ë° ì—´ê´€ë¥˜ìœ¨ ê³„ì‚°ê¸°</h2>

<label>ì§€ì—­:
  <select id="region">
    <option value="ì¤‘ë¶€1">ì¤‘ë¶€1ì§€ì—­</option>
    <option value="ì¤‘ë¶€2">ì¤‘ë¶€2ì§€ì—­</option>
    <option value="ë‚¨ë¶€">ë‚¨ë¶€ì§€ì—­</option>
    <option value="ì œì£¼">ì œì£¼ë„</option>
  </select>
</label>

<label>ë¶€ìœ„:
  <select id="zone">
    <option value="ì™¸ë²½">ì™¸ë²½</option>
    <option value="ì§€ë¶•">ì§€ë¶•</option>
    <option value="ë°”ë‹¥">ë°”ë‹¥</option>
  </select>
</label>

<h3>ğŸ¯ ë‹¨ì—´ì¬ ìˆ˜ë™ ì¶”ê°€</h3>
<input type="text" id="newName" placeholder="ì´ë¦„">
<input type="number" id="newLambda" placeholder="Î» (W/mÂ·K)">
<input type="text" id="newGrade" placeholder="ë“±ê¸‰ (ë¶ˆì—°/ì¤€ë¶ˆì—°)">
<input type="number" id="newPrice" placeholder="ê°€ê²©(ì›/ã¡)">
<button onclick="addCustomInsulation()">â• ì¶”ê°€</button>

<h3>ğŸ“‹ ë‹¨ì—´ì¬ ëª©ë¡ ë³´ê¸°</h3>
<table id="insulationTable">
  <thead><tr><th>ì´ë¦„</th><th>Î»</th><th>ë“±ê¸‰</th><th>ê°€ê²©</th></tr></thead>
  <tbody></tbody>
</table>

<label>ë‹¨ì—´ì¬ ë‘ê»˜ (mm):</label>
<input type="number" id="insulationThickness" />
<button onclick="calculate()">ê³„ì‚° ë° ì¶”ì²œ</button>
<button onclick="window.print()">ğŸ“„ PDFë¡œ ì €ì¥</button>

<div id="result"></div>

<script>
const uStandardTable = {
  'ì™¸ë²½': { 'ì¤‘ë¶€1': 0.15, 'ì¤‘ë¶€2': 0.17, 'ë‚¨ë¶€': 0.22, 'ì œì£¼': 0.29 },
  'ì§€ë¶•': { 'ì¤‘ë¶€1': 0.15, 'ì¤‘ë¶€2': 0.18, 'ë‚¨ë¶€': 0.25, 'ì œì£¼': 0.25 },
  'ë°”ë‹¥': { 'ì¤‘ë¶€1': 0.15, 'ì¤‘ë¶€2': 0.17, 'ë‚¨ë¶€': 0.22, 'ì œì£¼': 0.29 }
};

let insulationList = [
  {name: "PFë³´ë“œ A", lambda: 0.019, grade: "ë¶ˆì—°", price: 22000},
  {name: "ê²½ì§ˆìš°ë ˆíƒ„ B", lambda: 0.025, grade: "ì¤€ë¶ˆì—°", price: 18000},
  {name: "XPS C", lambda: 0.034, grade: "ë‚œì—°", price: 11000},
  {name: "ì§„ê³µë‹¨ì—´ D", lambda: 0.005, grade: "ë¶ˆì—°", price: 30000},
  {name: "EPS E", lambda: 0.038, grade: "ì¤€ë¶ˆì—°", price: 10000}
];

function updateInsulationTable() {
  const tbody = document.querySelector("#insulationTable tbody");
  tbody.innerHTML = "";
  for (const item of insulationList) {
    const row = `<tr><td>${item.name}</td><td>${item.lambda}</td><td>${item.grade}</td><td>${item.price}</td></tr>`;
    tbody.insertAdjacentHTML('beforeend', row);
  }
}

function addCustomInsulation() {
  const name = document.getElementById("newName").value;
  const lambda = parseFloat(document.getElementById("newLambda").value);
  const grade = document.getElementById("newGrade").value;
  const price = parseFloat(document.getElementById("newPrice").value);
  if (!name || isNaN(lambda)) {
    alert("ì´ë¦„ê³¼ Î»ë¥¼ ì •í™•íˆ ì…ë ¥í•˜ì„¸ìš”.");
    return;
  }
  insulationList.push({name, lambda, grade, price});
  updateInsulationTable();
}

function getGradeClass(lambda) {
  if (lambda <= 0.034) return 'grade-A';
  if (lambda <= 0.040) return 'grade-B';
  if (lambda <= 0.046) return 'grade-C';
  return 'grade-D';
}

function calculate() {
  const region = document.getElementById('region').value;
  const zone = document.getElementById('zone').value;
  const thickness = parseFloat(document.getElementById('insulationThickness').value) / 1000;
  const U_target = uStandardTable[zone][region];
  const R_required = 1 / U_target;

  const R_wall = 0.043 + 0.11;
  const R_needed = R_required - R_wall;
  const lambda_max = thickness / R_needed;

  const resultDiv = document.getElementById("result");
  resultDiv.innerHTML = `
    <p>ğŸ“Œ ê¸°ì¤€ ì—´ê´€ë¥˜ìœ¨: <b>${U_target} W/ã¡Â·K</b></p>
    <p>ğŸ§® í˜„ì¬ ë²½ì²´ ì—´ê´€ë¥˜ìœ¨ (U): <b>${(1 / (R_wall)).toFixed(3)} W/ã¡Â·K</b></p>
    <p>ğŸ¯ í•„ìš”í•œ Î» â‰¤ <b>${lambda_max.toFixed(3)} W/mÂ·K</b></p>
    <h3>âœ… ì¡°ê±´ ë§Œì¡± ë‹¨ì—´ì¬</h3>`;

  const ul = document.createElement("ul");
  for (const ins of insulationList) {
    if (ins.lambda <= lambda_max) {
      const li = document.createElement("li");
      li.textContent = `${ins.name} (Î»=${ins.lambda}, ${ins.grade}, ${ins.price}ì›/ã¡)`;
      li.className = getGradeClass(ins.lambda);
      ul.appendChild(li);
    }
  }
  resultDiv.appendChild(ul);
}

updateInsulationTable();
</script>
</body>
</html>
"""

# ì €ì¥
final_path.write_text(full_html, encoding="utf-8")
final_path.name
