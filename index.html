from pathlib import Path

<!DOCTYPE html><html lang="ko"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>단열재 추천 계산기</title><style>body{font-family:sans-serif;padding:20px}.tab{display:none}.tab.active{display:block}button.tab-btn{margin-right:10px;padding:10px 20px}table{border-collapse:collapse;width:100%;margin-top:10px}th,td{border:1px solid #ccc;padding:6px 10px;text-align:center}input,select{width:140px}.grade-A{background:#d4f8cc}.grade-B{background:#fff8b2}.grade-C{background:#ffe0b2}.grade-D{background:#f8cccc}#result{margin-top:30px}</style>
</head><body><h2>📦 단열재 추천 계산기</h2><div><button class="tab-btn" onclick="switchTab('calculator')">계산기</button><button class="tab-btn" onclick="switchTab('database')">단열재 목록</button></div>
<div class="tab active" id="calculator"><h3>📐 벽체 레이어 구성</h3>
<table id="layerTable"><thead><tr><th>재료명</th><th>두께 (mm)</th><th>열전도율 λ</th><th>열저항 R</th><th>삭제</th></tr></thead><tbody>
<tr class="fixed-layer"><td><input type="text" readonly value="실외 열전달저항"></td><td><input type="number" readonly value="0"></td><td><input type="text" readonly value="-"></td><td><input class="resistance" type="number" readonly value="0.043"></td><td></td></tr>
<tr onclick="selectRow(this)"><td><input class="material" list="insulationNames" placeholder="재료명" oninput="fillFromInput(this)"/></td>
<td><input type="number" oninput="updateResistance(this)"/></td><td><input type="number" oninput="updateResistance(this)"/></td><td><input class="resistance" type="number" readonly/></td>
<td><button onclick="removeRow(this)">삭제</button></td></tr>
<tr class="fixed-layer"><td><input type="text" readonly value="실내 열전달저항"></td><td><input type="number" readonly value="0"></td><td><input type="text" readonly value="-"></td><td><input class="resistance" type="number" readonly value="0.11"></td><td></td></tr></tbody></table>
<datalist id="insulationNames"></datalist><button onclick="addRow()">레이어 추가</button>
<h4>단열재 두께 (mm): <input id="insulationThickness" type="number"/></h4><h4>지역: 
<select id="region"><option value="중부1">중부1</option><option value="중부2">중부2</option><option value="남부">남부</option><option value="제주">제주</option></select> 부위:
<select id="zone"><option value="외벽">외벽</option><option value="지붕">지붕</option><option value="바닥">바닥</option></select></h4>
<button onclick="calculate()">추천</button> <button onclick="window.print()">📄 PDF 저장</button><div id="result"></div></div>
<div class="tab" id="database"><h3>📋 단열재 목록</h3><table id="insulationTable"><thead><tr><th>이름</th><th>λ</th><th>등급</th><th>가격</th></tr></thead><tbody></tbody></table>
<h4>➕ 단열재 추가</h4><input id="newName" placeholder="이름"/><input id="newLambda" placeholder="λ" type="number"/>
<input id="newGrade" placeholder="등급"/><input id="newPrice" placeholder="가격" type="number"/>
<button onclick="addCustomInsulation()">추가</button></div>
<script>
const uStandardTable = {'외벽':{'중부1':0.15,'중부2':0.17,'남부':0.22,'제주':0.29},
'지붕':{'중부1':0.15,'중부2':0.18,'남부':0.25,'제주':0.25},
'바닥':{'중부1':0.15,'중부2':0.17,'남부':0.22,'제주':0.29}};
let insulationList = [{name:"PF보드 A",lambda:0.019,grade:"불연",perm:0.2,price:22000},{name:"경질우레탄 B",lambda:0.025,grade:"준불연",perm:0.5,price:18000},
{name:"XPS C",lambda:0.034,grade:"난연",perm:1.5,price:11000},{name:"진공단열 D",lambda:0.005,grade:"불연",perm:0.01,price:50000},
{name:"EPS E",lambda:0.038,grade:"난연",perm:2.0,price:8000},{name:"EPS 난연 F",lambda:0.035,grade:"난연",perm:1.5,price:9000},
{name:"에어로겔 G",lambda:0.015,grade:"불연",perm:0.05,price:60000},{name:"PIR보드 H",lambda:0.021,grade:"준불연",perm:0.3,price:23000},
{name:"미네랄울 I",lambda:0.037,grade:"불연",perm:0.3,price:15000},{name:"그라스울 J",lambda:0.038,grade:"불연",perm:0.4,price:14000}];

function switchTab(id){document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));document.getElementById(id).classList.add('active');}
function updateResistance(input){const r=input.closest("tr"),t=parseFloat(r.cells[1].querySelector('input').value)/1000,l=parseFloat(r.cells[2].querySelector('input').value),R=r.cells[3].querySelector('input');R.value=!isNaN(t)&&!isNaN(l)&&l>0?(t/l).toFixed(3):'';}
function addRow(){const t=document.querySelector("#layerTable tbody"),r=document.createElement("tr");r.setAttribute("onclick","selectRow(this)"),r.innerHTML=`<td><input class="material" list="insulationNames" placeholder="재료명" oninput="fillFromInput(this)"/></td><td><input type="number" oninput="updateResistance(this)"/></td><td><input type="number" oninput="updateResistance(this)"/></td><td><input class="resistance" type="number" readonly/></td><td><button onclick="removeRow(this)">삭제</button></td>`;t.insertBefore(r,t.lastElementChild);}
function removeRow(b){b.closest("tr").remove();}
function selectRow(r){document.querySelectorAll("#layerTable tr").forEach(r=>r.classList.remove("selected"));r.classList.add("selected");}
function updateInsulationTable(){const t=document.querySelector("#insulationTable tbody");t.innerHTML="";insulationList.forEach(i=>{t.innerHTML+=`<tr><td>${i.name}</td><td>${i.lambda}</td><td>${i.grade}</td><td>${i.price}</td></tr>`});updateDatalist();}
function addCustomInsulation(){const n=document.getElementById("newName").value,l=parseFloat(document.getElementById("newLambda").value),g=document.getElementById("newGrade").value,p=parseFloat(document.getElementById("newPrice").value);if(!n||isNaN(l)){alert("이름과 λ를 입력하세요.");return;}
insulationList.push({name:n,lambda:l,grade:g,price:p});updateInsulationTable();}
function calculate(){const r=document.getElementById('region').value,z=document.getElementById('zone').value,t=parseFloat(document.getElementById('insulationThickness').value)/1000;let R=0;document.querySelectorAll(".resistance").forEach(i=>{const v=parseFloat(i.value);if(!isNaN(v))R+=v;});const U=uStandardTable[z][r],Rr=1/U,Rn=Rr-R,λ=t/Rn;
const res=document.getElementById("result");res.innerHTML=`<p>📌 기준 열관류율: <b>${U} W/㎡·K</b></p><p>🧮 현재 벽체 열관류율: <b>${(1/R).toFixed(3)} W/㎡·K</b></p><p>🎯 필요한 λ ≤ <b>${λ.toFixed(3)} W/m·K</b></p><h3>✅ 추천 단열재</h3>`;const ul=document.createElement("ul");insulationList.forEach(i=>{if(i.lambda<=λ){const li=document.createElement("li");li.textContent=`${i.name} (λ=${i.lambda}, ${i.grade}, ${i.price}원/㎡)`;ul.appendChild(li);}});res.appendChild(ul);}
function fillFromInput(input){const name=input.value,row=input.closest("tr"),ins=insulationList.find(i=>i.name===name);if(ins){const l=row.cells[2].querySelector('input');l.value=ins.lambda;updateResistance(l);}}
function updateDatalist(){const dl=document.getElementById("insulationNames");dl.innerHTML="";insulationList.forEach(i=>{const o=document.createElement("option");o.value=i.name;dl.appendChild(o);});}
updateInsulationTable();
</script></body></html>
"""
