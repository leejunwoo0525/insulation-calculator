from pathlib import Path

<!DOCTYPE html><html lang="ko"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ë‹¨ì—´ì¬ ì¶”ì²œ ê³„ì‚°ê¸°</title><style>body{font-family:sans-serif;padding:20px}.tab{display:none}.tab.active{display:block}button.tab-btn{margin-right:10px;padding:10px 20px}table{border-collapse:collapse;width:100%;margin-top:10px}th,td{border:1px solid #ccc;padding:6px 10px;text-align:center}input,select{width:140px}.grade-A{background:#d4f8cc}.grade-B{background:#fff8b2}.grade-C{background:#ffe0b2}.grade-D{background:#f8cccc}#result{margin-top:30px}</style>
</head><body><h2>ğŸ“¦ ë‹¨ì—´ì¬ ì¶”ì²œ ê³„ì‚°ê¸°</h2><div><button class="tab-btn" onclick="switchTab('calculator')">ê³„ì‚°ê¸°</button><button class="tab-btn" onclick="switchTab('database')">ë‹¨ì—´ì¬ ëª©ë¡</button></div>
<div class="tab active" id="calculator"><h3>ğŸ“ ë²½ì²´ ë ˆì´ì–´ êµ¬ì„±</h3>
<table id="layerTable"><thead><tr><th>ì¬ë£Œëª…</th><th>ë‘ê»˜ (mm)</th><th>ì—´ì „ë„ìœ¨ Î»</th><th>ì—´ì €í•­ R</th><th>ì‚­ì œ</th></tr></thead><tbody>
<tr class="fixed-layer"><td><input type="text" readonly value="ì‹¤ì™¸ ì—´ì „ë‹¬ì €í•­"></td><td><input type="number" readonly value="0"></td><td><input type="text" readonly value="-"></td><td><input class="resistance" type="number" readonly value="0.043"></td><td></td></tr>
<tr onclick="selectRow(this)"><td><input class="material" list="insulationNames" placeholder="ì¬ë£Œëª…" oninput="fillFromInput(this)"/></td>
<td><input type="number" oninput="updateResistance(this)"/></td><td><input type="number" oninput="updateResistance(this)"/></td><td><input class="resistance" type="number" readonly/></td>
<td><button onclick="removeRow(this)">ì‚­ì œ</button></td></tr>
<tr class="fixed-layer"><td><input type="text" readonly value="ì‹¤ë‚´ ì—´ì „ë‹¬ì €í•­"></td><td><input type="number" readonly value="0"></td><td><input type="text" readonly value="-"></td><td><input class="resistance" type="number" readonly value="0.11"></td><td></td></tr></tbody></table>
<datalist id="insulationNames"></datalist><button onclick="addRow()">ë ˆì´ì–´ ì¶”ê°€</button>
<h4>ë‹¨ì—´ì¬ ë‘ê»˜ (mm): <input id="insulationThickness" type="number"/></h4><h4>ì§€ì—­: 
<select id="region"><option value="ì¤‘ë¶€1">ì¤‘ë¶€1</option><option value="ì¤‘ë¶€2">ì¤‘ë¶€2</option><option value="ë‚¨ë¶€">ë‚¨ë¶€</option><option value="ì œì£¼">ì œì£¼</option></select> ë¶€ìœ„:
<select id="zone"><option value="ì™¸ë²½">ì™¸ë²½</option><option value="ì§€ë¶•">ì§€ë¶•</option><option value="ë°”ë‹¥">ë°”ë‹¥</option></select></h4>
<button onclick="calculate()">ì¶”ì²œ</button> <button onclick="window.print()">ğŸ“„ PDF ì €ì¥</button><div id="result"></div></div>
<div class="tab" id="database"><h3>ğŸ“‹ ë‹¨ì—´ì¬ ëª©ë¡</h3><table id="insulationTable"><thead><tr><th>ì´ë¦„</th><th>Î»</th><th>ë“±ê¸‰</th><th>ê°€ê²©</th></tr></thead><tbody></tbody></table>
<h4>â• ë‹¨ì—´ì¬ ì¶”ê°€</h4><input id="newName" placeholder="ì´ë¦„"/><input id="newLambda" placeholder="Î»" type="number"/>
<input id="newGrade" placeholder="ë“±ê¸‰"/><input id="newPrice" placeholder="ê°€ê²©" type="number"/>
<button onclick="addCustomInsulation()">ì¶”ê°€</button></div>
<script>
const uStandardTable = {'ì™¸ë²½':{'ì¤‘ë¶€1':0.15,'ì¤‘ë¶€2':0.17,'ë‚¨ë¶€':0.22,'ì œì£¼':0.29},
'ì§€ë¶•':{'ì¤‘ë¶€1':0.15,'ì¤‘ë¶€2':0.18,'ë‚¨ë¶€':0.25,'ì œì£¼':0.25},
'ë°”ë‹¥':{'ì¤‘ë¶€1':0.15,'ì¤‘ë¶€2':0.17,'ë‚¨ë¶€':0.22,'ì œì£¼':0.29}};
let insulationList = [{name:"PFë³´ë“œ A",lambda:0.019,grade:"ë¶ˆì—°",perm:0.2,price:22000},{name:"ê²½ì§ˆìš°ë ˆíƒ„ B",lambda:0.025,grade:"ì¤€ë¶ˆì—°",perm:0.5,price:18000},
{name:"XPS C",lambda:0.034,grade:"ë‚œì—°",perm:1.5,price:11000},{name:"ì§„ê³µë‹¨ì—´ D",lambda:0.005,grade:"ë¶ˆì—°",perm:0.01,price:50000},
{name:"EPS E",lambda:0.038,grade:"ë‚œì—°",perm:2.0,price:8000},{name:"EPS ë‚œì—° F",lambda:0.035,grade:"ë‚œì—°",perm:1.5,price:9000},
{name:"ì—ì–´ë¡œê²” G",lambda:0.015,grade:"ë¶ˆì—°",perm:0.05,price:60000},{name:"PIRë³´ë“œ H",lambda:0.021,grade:"ì¤€ë¶ˆì—°",perm:0.3,price:23000},
{name:"ë¯¸ë„¤ë„ìš¸ I",lambda:0.037,grade:"ë¶ˆì—°",perm:0.3,price:15000},{name:"ê·¸ë¼ìŠ¤ìš¸ J",lambda:0.038,grade:"ë¶ˆì—°",perm:0.4,price:14000}];

function switchTab(id){document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));document.getElementById(id).classList.add('active');}
function updateResistance(input){const r=input.closest("tr"),t=parseFloat(r.cells[1].querySelector('input').value)/1000,l=parseFloat(r.cells[2].querySelector('input').value),R=r.cells[3].querySelector('input');R.value=!isNaN(t)&&!isNaN(l)&&l>0?(t/l).toFixed(3):'';}
function addRow(){const t=document.querySelector("#layerTable tbody"),r=document.createElement("tr");r.setAttribute("onclick","selectRow(this)"),r.innerHTML=`<td><input class="material" list="insulationNames" placeholder="ì¬ë£Œëª…" oninput="fillFromInput(this)"/></td><td><input type="number" oninput="updateResistance(this)"/></td><td><input type="number" oninput="updateResistance(this)"/></td><td><input class="resistance" type="number" readonly/></td><td><button onclick="removeRow(this)">ì‚­ì œ</button></td>`;t.insertBefore(r,t.lastElementChild);}
function removeRow(b){b.closest("tr").remove();}
function selectRow(r){document.querySelectorAll("#layerTable tr").forEach(r=>r.classList.remove("selected"));r.classList.add("selected");}
function updateInsulationTable(){const t=document.querySelector("#insulationTable tbody");t.innerHTML="";insulationList.forEach(i=>{t.innerHTML+=`<tr><td>${i.name}</td><td>${i.lambda}</td><td>${i.grade}</td><td>${i.price}</td></tr>`});updateDatalist();}
function addCustomInsulation(){const n=document.getElementById("newName").value,l=parseFloat(document.getElementById("newLambda").value),g=document.getElementById("newGrade").value,p=parseFloat(document.getElementById("newPrice").value);if(!n||isNaN(l)){alert("ì´ë¦„ê³¼ Î»ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");return;}
insulationList.push({name:n,lambda:l,grade:g,price:p});updateInsulationTable();}
function calculate(){const r=document.getElementById('region').value,z=document.getElementById('zone').value,t=parseFloat(document.getElementById('insulationThickness').value)/1000;let R=0;document.querySelectorAll(".resistance").forEach(i=>{const v=parseFloat(i.value);if(!isNaN(v))R+=v;});const U=uStandardTable[z][r],Rr=1/U,Rn=Rr-R,Î»=t/Rn;
const res=document.getElementById("result");res.innerHTML=`<p>ğŸ“Œ ê¸°ì¤€ ì—´ê´€ë¥˜ìœ¨: <b>${U} W/ã¡Â·K</b></p><p>ğŸ§® í˜„ì¬ ë²½ì²´ ì—´ê´€ë¥˜ìœ¨: <b>${(1/R).toFixed(3)} W/ã¡Â·K</b></p><p>ğŸ¯ í•„ìš”í•œ Î» â‰¤ <b>${Î».toFixed(3)} W/mÂ·K</b></p><h3>âœ… ì¶”ì²œ ë‹¨ì—´ì¬</h3>`;const ul=document.createElement("ul");insulationList.forEach(i=>{if(i.lambda<=Î»){const li=document.createElement("li");li.textContent=`${i.name} (Î»=${i.lambda}, ${i.grade}, ${i.price}ì›/ã¡)`;ul.appendChild(li);}});res.appendChild(ul);}
function fillFromInput(input){const name=input.value,row=input.closest("tr"),ins=insulationList.find(i=>i.name===name);if(ins){const l=row.cells[2].querySelector('input');l.value=ins.lambda;updateResistance(l);}}
function updateDatalist(){const dl=document.getElementById("insulationNames");dl.innerHTML="";insulationList.forEach(i=>{const o=document.createElement("option");o.value=i.name;dl.appendChild(o);});}
updateInsulationTable();
</script></body></html>
"""
